#### [ 목차 ] ####

**1. 모델 실행 결과 이력 관리**   

- [(1-1) 개요](#1.1.-개요)  
- [(1-2) 관리 대상 정보](#1.2.-관리-대상-정보)  
- [(1-3) 실행 파일 구성](#1.3.-실행-파일-구성) 

**2. (DB) 결과 실행 테이블 관리 모듈 사용법**  
  
- [(2-1) 환경 설정](#2.1-환경-설정)
  - [(2-1-1) JDBC 설치](#2.1.1.-JDBC-설치)
  - [(2-1-2) Config 정보 변경](#2.1.2.-Config-정보-변경)  
  
  
  
- [(2-2) 코드 실행 방법](#2.2-코드-실행-방법)  
  
  
  
- [(2-3) 모델 실행 결과 이력 (운영계)](#2.3-모델-실행-결과-이력-(운영계))
  - [(2-3-1) 초기 실행](#2.3.1-초기-실행)  
  - [(2-3-2) 함수 직접 호출 방식](#2.3.2-함수-직접-호출-방식)  
  
**3. 부록**  
- [(3.1) (Excel) 결과 실행 파일 관리 모듈 사용법](#3.-(Excel)-결과-실행-파일-관리-모듈-사용법)
  
<br/> <br/> <br/> <br/>
  
### 1. 모델 실행 결과 이력 관리 ###  


![테이블_샘플_이미지](https://user-images.githubusercontent.com/104196127/165253837-6f05136b-1871-40b9-aae1-b957e4105f79.jpg)


#### 1.1. 개요 ####


    프로젝트 내 분석 모델들의 실행 결과를 DB 테이블 내에서 자동 관리하는 모듈 
        
            - 분석 모델 명칭(model_nm)과 모델 실행 일자(stdr_de)를 기록하며, 실행 상태를 코드로 구분하여 관리(run_rslt) 
            
    (개발 환경과 독립된) 운영 환경에서 분석 모델이 정상적으로 작동하는지 지속적으로 확인 및 관리하기 위한 용도      
      
    

#### 1.2. 관리 대상 정보 ####
    
    model_nm (model_name)   :  분석 모델의 명칭 

    stdr_de (standard date) :  해당 모델의 실행 날짜 
                                       - (운영계 활용시) 배치 기준 날짜
                              
                                          ex.)
                                              (일 배치 모델) '20220101' 또는 '2021-01-01' 등 
                                              (월 배치 모델)  '202202' 또는 '2022-02' 등
                        

    run_rslt (run_result)   :   모델 실행 상태 관리 코드  
                                           ---------------------
                                          | 모델 실행 이전 : 0  | 
                                          | 모델 실행 완료 : 1  |
                                          | 모델 실행 오류 : 9  |
                                           ---------------------

    c_time (current_time)   :   (해당 Row의) 최종 업데이트 시간


#### 1.3. 실행 파일 구성 ####

    1) 코드 실행 파일 (Main 실행 파일)
    
        1-1) run_rslt.ipynb  
        
    
    2) Import Library (Import 해야하는 모듈) 
    
        2-1) (Common 폴더 내) run_rslt_DB.py      # DB 활용 가능 분석 환경 
        
        2-2) (Common 폴더 내) rum_rslt_Excel.py   # DB 활용 불가능한 분석 환경 
        
        
        
<br/> <br/> <br/>
### 2.(DB) 결과 실행 테이블 관리 모듈 사용법 ###
  
  
#### 2.1. 환경 설정 #### 
    (DB 접속 환경의 경우) Python과 DB Connection을 위한 환경 설정이 필요합니다.
  
  
#### 2.1.1. JDBC 설치 ####
            
![JDBC](https://user-images.githubusercontent.com/104196127/165254843-e5320655-8105-4bd1-896f-81625f96f0de.jpg)
            
        - DB 환경에 적합한 JDBC 다운로드 후 [ROOT_PATH/lib] 에 저장 (.jar)
            
            [  다운로드 링크 ] 
                * ORACLE : https://www.oracle.com/kr/database/technologies/appdev/jdbc-downloads.html
                * MY_SQL : https://dev.mysql.com/downloads/connector/j/]<https://dev.mysql.com/downloads/connector/j/
            
            
            
#### 2.1.2. Config 정보 변경 ####
            
![config](https://user-images.githubusercontent.com/104196127/165253918-681e85ab-5491-410c-8dd9-494287a6203c.jpg)
            
        (Python) DB Connection을 위한 연결 정보 등록
            
            - Config 폴더 내 config.yaml 파일 DB 정보 수정 
                

                Jclassname : 해당 DB 드라이버 명칭         
                                                           
                URL : 서버 주소 (또는 로컬 주소)           
                                                           
                Driver_args :                              
                    - 계정 ID                              
                    - 계정 PW                              
                                                          
                jars : JDBC 드라이버 (.jar) 설치 파일 경로 
                
                        (* 입력시 따옴표('/") 필요 없음 ) 



#### 2.2 코드 실행 방법 #### 
    
    [ 개요 ] 

      DB 가 정상적으로 연결되었다면, 모델 실행 시 해당 모듈이 자동으로 결과를 관리합니다. 
    
    
    [ 코드 실행 순서 ] 
    
    
    1) run_rslt.ipynb 열기
    
       # [Screen_shot_1] #  
    
    
    
    2) DB 결과 관리 모듈 Import
    
      ex) from common.run_rslt_DB import model_run_rslt
        
        # [Screen_shot_2] #
        
        
    3) 관리하고자 하는 모델 명칭과 기준 날짜 변수 할당 
        
        # [Screen_shot_3] #
        
        모델 명칭      : str(문자열)
        모델 실행 날짜 : str(문자열)
        
        
        
    4) 함수 내 모델 실행 코드 삽입 
    
        - Sample code 부분을 지운 뒤, 분석 모델 전체 코드 삽입  
            - 데코레이터(decorator)가 부착된 함수 생성 (*함수 명칭 자유롭게 변경)
            
    
    5) 결과 실행 테이블 내 적재 확인 

        - 함수 호출 후 DB 내 'model_run_rslt' 테이블 확인 
        
             ex.) select * from model_run_rslt
        
        
        

#### 2.3 모델 실행 결과 이력 (운영계) ####  

- 운영계에서 결과 관리 테이블을 활용하는 경우 해당 부분을 참고해주세요. (붉은색 표기) 
    
        
        
#### 2.3.1 초기 실행 #### 
    
    
        [ 개요 ]
        
            
        - 운영 환경이 개발 환경과 독립적인 경우, 개발 과정에서 실행했던 모델의 이전 '실행 결과 이력'을 운영DB에 재 생성합니다. 


        [ 활용 방식 ] 
        
        
        - (common 폴더 내) run_rslt_DB.py 를 Import 한 뒤 클래스 내 insert_model_run_rslt_list 함수를 사용합니다.
                
                -> 리스트 형태로 결과 이력을 일괄적으로 생성하도록하는 함수 
                
            
        - 주석(또는 __doc__ ) 내 예시와 설명을 참고하여, 운영단에서 해당 코드를 실행하여 이전 결과 이력을 재 생성합니다.
        
            
                -> 초기 생성 파일 (ex.init.py)을 활용하는 경우 해당 코드 내에 삽입하는 방식으로 진행 권장
                
        
                                                                                    (* 2.3.2 함수 직접 호출 방식 참조) 
        
           
#### 2.3.2 함수 직접 호출 방식 ####
        
        [ 개요 ]
        
        
        -접근이 제한적인 환경의 경우(ex.DB에 직접 접근이 불가능한 경우 또는 CLI(Command Line Interface) 환경의 경우) 
        
        결과 관리 테이블에 대한 조작을 위해서는 모듈 내 함수를 직접 호출하여 사용합니다. 
        
        
        [ 활용 순서 ] 
        
        
        1) python 실행
            
            
        2) model_run_DB Import
            
            
        3) 클래스 내 주석 출력하여 관련 함수 확인 
            
            - print(model_run_DB.__doc__)
                
            - 드래그 복사 후 붙여넣기 
                
            - 변수명 필요에 맞게 변경 
                
            - 코드 실행
                
        4) 필요한 함수 내 주석 출력하여 사용법 및 예제 확인 
                
            - print([특정 함수명].__doc__)

            - 드래그 복사 후 붙여넣기 
                
            - 변수명 필요에 맞게 변경 
                
            - 코드 실행                
       
       
<br/> <br/> <br/>            
 ### 3. (Excel) 결과 실행 파일 관리 모듈 사용법 ###

- DB 활용이 불가능하지만 결과 이력관리가 필요한 경우 사용합니다.  

    [ 개요 ]
    
    - DB 활용이 불가능한 환경에서 모델 실행 결과 관리를 위한 모듈 (.csv 파일 형태로 저장/관리)

    
    [ 사용 방법 ] 
    
    - Common 폴더 내 run_rslt_Excel 를 Import 하여 사용
    
    - 이후 사용 방법은 이전 모듈(run_rslt_DB) 과 동일합니다. 
    
            (*내부 함수 구성은 다르며 필요 시 주석 참고) 
    
    
    [ 파일 디렉토리 ] 

    - Root_Path/result 폴더 내 파일 저장 (model_run_rslt.csv)

        - 모델이 실행될 때 마다 저장된 파일의 이력 자동 관리 

    
    [ 운영계 이관시 ] 
    
    - 운영계 이관시 해당 파일 (운영계 기준) Root_Path/result 폴더에 저장하여 관리            
